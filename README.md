# **1. üìä An√°lisis de ventas de una cadena de tiendas de comestibles ficticia.**


# **2. üìñ Descripci√≥n**

En este proyecto realizaremos un an√°lisis exploratorio de datos (EDA) inicial con Python de las ventas de una cadena de tiendas ficticia de comestibles.

Posteriormente, visualizaremos los datos con Power BI para poder interactuar con ellos y analizar en profundidad.

El objetivo del an√°lisis es visualizar en Power BI los siguientes aspectos:

    - Ventas:
        ‚Ä¢	Distribuci√≥n de ventas por productos y categor√≠as.
        ‚Ä¢	Tendencias de ventas a lo largo del tiempo.
        ‚Ä¢	Comparaci√≥n de ventas por horas.

    - Clientes:
        ‚Ä¢	An√°lisis demogr√°fico de los clientes.
        ‚Ä¢	Segmentaci√≥n de clientes seg√∫n comportamiento de compra.
        ‚Ä¢	Identificaci√≥n de clientes potenciales y principales.

    - Empleados:
        ‚Ä¢	Rendimiento individual.
        ‚Ä¢	An√°lisis demogr√°fico de los empleados.
        ‚Ä¢	An√°lisis de la edad y la antig√ºedad.

# **3. üóÇÔ∏è Estructura del proyecto**

Carpetas y archivos de este proyecto:

    üóÇÔ∏è data/        # Datos crudos y procesados
        üóÇÔ∏è raw_data/        # Datos crudos

           üìë categories.csv: listado de categor√≠as
                Columnas: 
                        CategoryID: identificador √∫nico para cada categor√≠a de producto
                        CategoryName: nombre de la categor√≠a del producto
           
           üìë cities.csv: listado de ciudades
                Columnas:
                        CityID: identificador √∫nico para cada ciudad
                        CityName: nombre de la ciudad
                        Zipcode: c√≥digo postal
                        CountryID: identificador √∫nico para cada pa√≠s

           üìë countries.csv: listado de paises
                Columnas:
                        CountryID: identificador √∫nico para cada pa√≠s
                        CountryName: nombre del pa√≠s
                        CountryCode: c√≥digo de dos letras del pa√≠s

           üìë customers.csv: contiene informaci√≥n sobre los clientes
                Columnas: 
                        CustomerID: identificador √∫nico de cada cliente
                        FirstName: nombre del cliente
                        MiddleInitial: middle name (usado en Estados Unidos)
                        LastName: apellido del cliente
                        CityID: identificador √∫nico para cada ciudad
                        Address: direcci√≥n del cliente

           üìë employees.csv: contiene informaci√≥n sobre los empleados 
                Columnas:
                        EmployeeID: identificador √∫nico de cada empleado
                        FirstName: nombre del empleado
                        MiddleInitial: middle name (usado en Estados Unidos)
                        LastName: apellido del empleado
                        BirthDate: fecha de nacimiento
                        Gender: g√©nero
                        CityID: identificador √∫nico para cada ciudad
                        HireDate: fecha en la que el empleado fue contratado

           üìë products.csv: contiene informaci√≥n sobre los productos
                Columnas:
                        ProductID: identificador √∫nico de cada producto
                        ProductName: nombre de cada producto
                        Price: precio por unidad de producto
                        CategoryID: identificador √∫nico para cada categor√≠a de producto
                        Class: clasificaci√≥n del producto
                        ModifyDate: √∫ltima fecha de modificaci√≥n
                        Resistant: categor√≠a de resistencia
                        IsAllergic: indica si el producto es al√©rgico o no
                        VitalityDays: caducidad en d√≠as del producto

           üìë sales.csv: contiene informaci√≥n sobre cada venta 
                Columnas:
                        SalesID: identificador √∫nico de cada venta
                        SalesPersonID: empleado responsable de la venta
                        CustomerID: cliente que realiza la compra
                        ProductID: producto comprado
                        Quantity: n√∫mero de unidades vendidas
                        Discount: descuento aplicado a la venta
                        TotalPrice: precio final despu√©s de aplicar descuentos
                        SalesDate: fecha y hora de la venta
                        TransactionNumber: identificador √∫nico de la transacci√≥n

        üóÇÔ∏è clean_data/        # Datos procesados listos para visualizar en Power BI

    üóÇÔ∏è notebooks/   # Notebooks de Jupyter con el an√°lisis y limpieza de datos

            üìì 1. Prean√°lisis.ipynb
            üìì 2. Limpieza.ipynb

    üóÇÔ∏è src/         # Scripts de procesamiento

           üìú sp_analisis.py: archivo de soporte para funciones
           üìú sp_rutas.py: archivo de soporte para rutas (no se sube a Github por privacidad)

    üìÉ README.MD    # Archivo Readme   
    üìÉ Informe de an√°lisis.pdf  # Informe final                                     

# **4. üõ†Ô∏è Instalaci√≥n y Requisitos**

En este proyecto he usado Python 3.13.1 y requiere las siguientes bibliotecas:

    - pandas
    - numpy
    - matplotlib
    - seaborn
    - datetime

# **5. üìä Resultados y Conclusiones**

## **5.1 üìä Resultados del EDA con Python**

### An√°lisis Exploratorio de Datos (EDA)

El EDA es una fase crucial en el an√°lisis de datos, ya que permite comprender la estructura de los datos y detectar patrones, anomal√≠as y relaciones significativas. Para llevar a cabo este an√°lisis, se utilizaron los archivos de datos originales y se emplearon diversas librer√≠as de Python como por ejemplo pandas y datetime entre otras.

### Proceso de Limpieza de Datos

Se analiz√≥ cada archivo individualmente para ver qu√© transformaciones eran necesarias.

#### An√°lisis inicial del archivo "categories":

        1. Tipo de datos a cambiar: no es necesario hacer ning√∫n cambio

        2. Categor√≠as a cambiar: 

            - Cambiar el nombre de las columnas:

                - **CategoryId** -> Category_Id
                - **CategoryName** -> Category_Name

        3. Columnas con valores nulos: no hay

        4. Columnas a eliminar: no es necesario eliminar ninguna columna

#### An√°lisis inicial del archivo "cities":

        1. Tipo de datos a cambiar: no es necesario hacer ning√∫n cambio

        2. Categor√≠as a cambiar: 

            - Cambiar nombre de las columnas:
            
                - **CityID** -> City_Id
                - **CityName** -> City_Name
                - **CountryID** -> Country_Id

        3. Columnas con valores nulos: no hay

        4. Columnas a eliminar: no es necesario eliminar ninguna columna

#### An√°lisis inicial del archivo "countries":

        1. Tipo de datos a cambiar: no es necesario hacer ning√∫n cambio

        2. Categor√≠as a cambiar: 

            - Cambiar nombre de las columnas:

                - **CountryID** -> Country_Id
                - **CountryName** -> Country_Name
                - **CountryCode** -> Country_Code

        3. Columnas con valores nulos: 

            - **CountryCode**: 1 valor nulo

        4. Columnas a eliminar: **CountryCode** no aporta valor a nuestro an√°lisis

#### An√°lisis inicial del archivo "customers":

        1. Tipo de datos a cambiar: no es necesario hacer ning√∫n cambio

        2. Categor√≠as a cambiar:

            - Cambiar nombre de las columnas:

                - **CustomerID** -> Customer_Id
                - **CityID** -> City_Id

        3. Columnas con valores nulos: 

            - **MiddleInitial**: 977 valores nulos

        4. Columnas a eliminar: 
            - Eliminar 'MiddleInitial' ya que no es necesaria para nuestro an√°lisis
            - Concatenar las columnas 'FirstName' y 'LastName' en una sola, 'Full_Name' y eliminar las otras 2
            - Eliminar 'Address' ya que no es necesaria para nuestro an√°lisis

#### An√°lisis inicial del archivo "employees":

        1. Tipo de datos a cambiar: 

            - **BirthDate**: object -> datetime
            - **HireDate**: object -> datetime

        2. Categor√≠as a cambiar: 

            - **BirthDate**: dejar s√≥lo la fecha
            - **Gender**: cambiar 'M' por Male y 'F' por Female
            - **HireDate**: dejar s√≥lo la fecha
            - Cambiar nombre de las columnas:

                - **EmployeeID** -> Employee_Id
                - **BirthDate** -> Birth_Date
                - **CityID** -> City_Id
                - **HireDate** -> Hire_Date

            - Crear columna **Age** (edad del empleado) a partir de Birth_Date y **Seniority** (antig√ºedad del empleado en la empresa) a partir de Hire_Date

        3. Columnas con valores nulos: no hay

        4. Columnas a eliminar: 
            - Eliminar 'MiddleInitial' ya que no es necesaria para nuestro an√°lisis
            - Concatenar las columnas 'FirstName' y 'LastName' en una sola, 'Full_Name' y eliminar las otras 2

#### An√°lisis inicial del archivo "products":

        1. Tipo de datos a cambiar: 

            - **ModifyDate**: object -> datetime
            - **VitalityDays**: float -> int

        2. Categor√≠as a cambiar: 

            - Cambiar nombre de las columnas:

                - **ProductID** -> Product_Id
                - **ProductName** -> Product_Name
                - **CategoryID** -> Category_Id
                - **ModifyDate** -> Modify_Date
                - **IsAllergic** -> Is_Allergic
                - **VitalityDays** -> Vitality_Days

            - **ModifyDate**: dejar s√≥lo la fecha
            - **Is_Allergic**: cambiar True por Allergic, False por Not Allergic

        3. Columnas con valores nulos: no hay

        4. Columnas a eliminar: no son de inter√©s para nuestro an√°lisis

#### An√°lisis inicial del archivo "sales":

        1. Tipo de datos a cambiar: 

            - **SalesDate**: object -> datetime

        2. Categor√≠as a cambiar: 

            - Cambiar nombre de las columnas:

                - **SalesID** -> Sales_Id
                - **SalesPersonID** -> Sales_Person_Id
                - **CustomerID** -> Customer_Id
                - **ProductID** -> Product_Id
                - **SalesDate** -> Sales_Date

            - **Sales_Date**: dejar s√≥lo la fecha y crear una nueva columna s√≥lo con la hora (no los minutos) para ver las ventas por horas

            - Crear nueva columna Total_Price obteniendo el precio del producto del archivo 'products' y aplicando el descuento.

        3. Columnas con valores nulos: 

            - **SalesDate**. 67526 valores nulos

        4. Columnas a eliminar: 

            - **TransactionNumber**: no aporta valor a nuestro an√°lisis
            - **TotalPrice**: todos los valores son ceros

A modo de resumen, tras finalizar el EDA, se identificaron y corrigieron problemas de calidad de datos como:

-	Homogeneizar el nombre de las columnas
-	Eliminar columnas innecesarias que no aportaban valor al an√°lisis
-	Gesti√≥n de valores nulos y faltantes
-	Transformaciones varias de fechas
-	Creaci√≥n de nuevas columnas con informaci√≥n 

Los datos limpios se guardaron en otra carpeta con la terminaci√≥n "_clean" para diferenciarlos de los archivos originales. Este proceso asegur√≥ que los datos fueran precisos y adecuados para el an√°lisis posterior.


## **5.2 üìä Resultados del an√°lisis con Power BI**

### Creaci√≥n del Dashboard en Power BI

Una vez limpiados los datos, se importaron en Power BI para elaborar un dashboard interactivo que permitiera visualizar y analizar diferentes aspectos del negocio. El dashboard incluye varias visualizaciones clave enfocadas en:
    
    Ventas
        ‚Ä¢	Distribuci√≥n de ventas por productos y categor√≠as.
        ‚Ä¢	Tendencias de ventas a lo largo del tiempo.
        ‚Ä¢	Comparaci√≥n de ventas por horas.
    
    Clientes
        ‚Ä¢	An√°lisis demogr√°fico de los clientes.
        ‚Ä¢	Segmentaci√≥n de clientes seg√∫n comportamiento de compra.
        ‚Ä¢	Identificaci√≥n de los principales clientes.
    
    Empleados
        ‚Ä¢	Rendimiento individual.
        ‚Ä¢	An√°lisis demogr√°fico de los empleados.
        ‚Ä¢	An√°lisis de la edad y la antig√ºedad.
### Modelado y transformaci√≥n de los datos

#### Combinaci√≥n de tablas

Con el fin de conseguir un modelo en estrella, se realizan las siguientes combinaciones de tablas:

    ‚Ä¢	Se combina la tabla ‚Äúcities_clean‚Äù con ‚Äúcountries_clean‚Äù.
    ‚Ä¢	Se combina la tabla ‚Äúcustomers_clean‚Äù con ‚Äúcities_clean‚Äù, y ‚Äúemployees_clean‚Äù con ‚Äúcities_clean‚Äù.
    ‚Ä¢	Se combina la tabla ‚Äúproducts_clean‚Äù con ‚Äúcategories_clean‚Äù.

#### Agrupaci√≥n de tablas

Con el fin de obtener la categor√≠a de los clientes en base al valor de ‚ÄúTotal_Price‚Äù de la tabla ‚Äúsales_clean‚Äù, se duplica la tabla ‚Äúsales_clean‚Äù y se agrupan la suma de ‚ÄúTotal_Price‚Äù por  ‚ÄúCustomer_Id‚Äù. Posteriormente, se combina con ‚Äúcustomers_clean‚Äù y se crea una columna donde se aplica la l√≥gica para categorizar a los clientes.

### Hallazgos y consideraciones

Hay dos hallazgos clave que caben ser resaltados antes de comentar las visualizaciones y an√°lisis del punto anterior.

El primer hallazgo clave es que **hay productos cuya categor√≠a no concuerda con la descripci√≥n del producto**. Por ejemplo, dentro de la categor√≠a ‚ÄúMeat‚Äù (carne) hay productos como pl√°tanos, agua carbonatada o vino. En el caso de que fueran datos reales, ser√≠a conveniente advertir a la empresa que genera los datos que hay productos mal categorizados.

El segundo hallazgo clave es que, aunque en el archivo ‚Äúcountries‚Äù aparecen pa√≠ses de todo el mundo, el archivo ‚Äúcities‚Äù s√≥lo contiene datos de ventas en Estados Unidos (pa√≠s con identificador n√∫mero 32). En consecuencia, **el archivo ‚Äúsales‚Äù s√≥lo contiene datos de ventas en Estados Unidos.**

Una consideraci√≥n a tener en cuenta tambi√©n. Para el an√°lisis de este conjunto de datos, asumo que la ciudad de la tabla ‚Äúcustomers‚Äù es la ciudad de procedencia del cliente. Del mismo modo asumo que, la ciudad de la tabla ‚Äúemployees‚Äù, es la ciudad en la que trabaja el empleado y, en consecuencia, la ciudad en la que hay tienda f√≠sica y donde analizaremos la facturaci√≥n por ciudades.

## 5.3 üí° Conclusiones

Estas son las conclusiones tras el an√°lisis.

### Ventas

    ‚Ä¢	El producto que m√°s factura es ‚ÄúBread ‚Äì Calabrese Baguette‚Äù con $18,87 millones seguido de ‚ÄúShrimp ‚Äì 31/40‚Äù con $18,72 millones. 
    ‚Ä¢	Por categor√≠as, la categor√≠a con mayor facturaci√≥n es ‚ÄúConfections‚Äù con casi $557 millones. Hay que destacar aqu√≠ que, dado el problema de productos mal categorizados, este dato no es fiable. De todas formas, se deja en el dashboard ya que, si en el futuro se corrige este error, aparecer√≠a el an√°lisis correctamente s√≥lo con actualizar el informe. 
    ‚Ä¢	Como se puede observar en el gr√°fico de ‚ÄúVentas por Semana‚Äù, las ventas son muy estables semana a semana en el periodo del que disponemos datos. En semana 1 y semana 19, la facturaci√≥n es menor debido a que se abrieron menos d√≠as.
    ‚Ä¢	En el periodo dado, la hora con m√°s facturaci√≥n es entre las 16 h y las 17 h, y la que menos entre las 3 h y las 4 h.
### Clientes

    ‚Ä¢	Tucson es la ciudad de la que mayor n√∫mero de clientes proceden, 1.104. 
    ‚Ä¢	El cliente que m√°s ha gastado es Wayne Chan de la ciudad de Washington.
    ‚Ä¢	Segmentaci√≥n de clientes seg√∫n importe de compra:
        o	VIP (Compras >= $80.000): suponen el 17,67% del total
        o	Medio (Compras entre $23.000 y $80.000): suponen el 75,02%
        o	Bajo (Compras < $23.000): suponen el 7,3% 
    ‚Ä¢	En el gr√°fico de Ventas por Hora se puede analizar individualmente para cada cliente sus h√°bitos de consumo, a qu√© horas compras m√°s y a qu√© horas menos.

### Empleados

    ‚Ä¢	El empleado con mayor facturaci√≥n es Devon Brewer en la ciudad de Baltimore con $190 millones.
    ‚Ä¢	La ciudad con mayor n√∫mero de empleados es Lubbock con 3 empleados, seguida con 2 por Baltimore, Columbus y New Orleans.
    ‚Ä¢	Los empleados se distribuyen de la siguiente forma: 8 mujeres (34,78%) y 15 hombres (65,22%).
    ‚Ä¢	La distribuci√≥n de las edades por g√©nero es la siguiente:
        o	Mujeres:
            ÔÇß	Media de edad 59,25 a√±os
            ÔÇß	Edad m√≠nima: 44 a√±os
            ÔÇß	Edad m√°xima: 74
        o	Hombres: 
            ÔÇß	Media de edad: 56,47
            ÔÇß	Edad m√≠nima: 36
            ÔÇß	Edad m√°xima: 74
    ‚Ä¢	La antig√ºedad media en la empresa de los empleados es de 12,38 a√±os para las mujeres y 11,6 para los hombres.

### Recomendaciones

Basado en los hallazgos del an√°lisis, se recomienda:

    ‚Ä¢	Corregir la tabla ‚Äúproducts‚Äù, en concreto, asignar a cada producto su categor√≠a correcta.
    ‚Ä¢	Ser√≠a conveniente a√±adir una tabla ‚Äústores‚Äù donde se indique la localizaci√≥n correcta de cada tienda.
    ‚Ä¢	Implementar estrategias de marketing personalizadas para las distintas categor√≠as de clientes identificadas.
    ‚Ä¢	La edad media de los trabajadores (tanto mujeres como hombres) es bastante elevada. Ser√≠a conveniente planificar a medio plazo el relevo de los empleados con gente m√°s joven.

# **6. üîÑ Pr√≥ximos pasos**

Una vez se corrija el tema de las categor√≠as para cada producto, ser√≠a interesante realizar un an√°lisis de los productos perecederos a trav√©s de la columna "Vitality_Days".

# **7. ü§ù Contribuciones**

**¬°Las contribuciones son bienvenidas!**

# **8. üëè Autores y agradecimientos** 

**Agradecimientos:** gracias a los profesores de thePower, en especial a Silvia Alsina Ru√≠z, Jaime Roll√≥n Castro y Pablo Quintela Garc√≠a, ¬°¬°unos aut√©nticos cracks!!

**Autor:**
  - Ra√∫l Aristu
  - @raristu (https://github.com/raristu)

